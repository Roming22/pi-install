#cloud-config
#
# https://cloudinit.readthedocs.io/
#

hostname: %host.name%

# Update the system
#package_update: true
#package_upgrade: true

users:
- name: pi
  shell: /bin/bash
  ssh-authorized-keys:
    - %ssh.ubuntu.authorized_keys%
  groups:
    - ubuntu
    - docker
  sudo:
    - ALL=(ALL) NOPASSWD:ALL

packages:
  - apt-transport-https
  - ca-certificates
  - curl
  - gnupg-agent
  - software-properties-common

runcmd:
  - /root/install/docker.sh
  - /root/install/microk8s.sh
  - rm -rf /root/install

# Reboot after first boot
power_state:
  delay: "now"
  message: Device is configured and up to date. Rebooting...
  mode: reboot
